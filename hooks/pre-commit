#!/bin/bash

# Pre-commit hook to run tests before allowing commits
# This ensures all tests pass before any commit is made

echo "🧪 Running tests before commit..."

# Change to the repository root directory
cd "$(git rev-parse --show-toplevel)"

# Run the test suite using the project's test runner
python run_tests.py

# Capture the exit code
test_exit_code=$?

# If tests failed, prevent the commit
if [ $test_exit_code -ne 0 ]; then
    echo ""
    echo "❌ Tests failed! Commit aborted."
    echo "Please fix the failing tests before committing."
    exit 1
fi

echo ""
echo "✅ All tests passed! Proceeding with commit..."
exit 0